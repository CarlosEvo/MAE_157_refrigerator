%% AXV_1

results_AXV_1 = struct();

% 15 psig data point index
idx_7 = 1;

% #1: T1 gives enthalpy and entropy (saturated liquid)
results_AXV_1.H_1 = interp1(R12_sat.T, R12_sat.H_f, data.T1(idx_7));
% results_AXV_1.S_1 = interp1(R12_sat.T, R12_sat.S_f, data.T1(idx_7));

% #2: same enthalpy, T2 gives quality x
results_AXV_1.H_2 = results_AXV_1.H_1;

% #3: pressure table
[T, P] = meshgrid(248.15: 5: 393.15, [110, 120] .* 1000);
results_AXV_1.H_3 = interp2(...
    T, P, [R12_P_3.H_110(2: end), R12_P_4.H_120(1: end - 1)].',...
    data.T3(idx_7), data.P3(idx_7)...
);
results_AXV_1.S_3 = interp2(...
    T, P, [R12_P_3.S_110(2: end), R12_P_4.S_120(1: end - 1)].',...
    data.T3(idx_7), data.P3(idx_7)...
);

% #4
% Experimental Value
[T, P] = meshgrid(R12_P_14.T, [750, 800] .* 1000);
% Ideal value
results_AXV_1.S_4_ideal = results_AXV_1.S_3;
results_AXV_1.T_4_ideal = fzero(...
    @(T_4_ideal) interp2(...
        T, P,...
        [R12_P_14.S_750, R12_P_14.S_800].',...
        T_4_ideal, data.P4(idx_7)...
    ) - results_AXV_1.S_4_ideal,...
    data.T5(idx_7) + 50 ...
);
results_AXV_1.H_4_ideal = interp2(...
    T, P,...
    [R12_P_14.H_750, R12_P_14.H_800].',...
    results_AXV_1.T_4_ideal, data.P4(idx_7)...
);

% Coefficient of performance
results_AXV_1.COP_real = COP_real(data.mass(idx_7), results_AXV_1.H_2, results_AXV_1.H_3);
results_AXV_1.COP_ideal = COP_ideal(...
    results_AXV_1.H_2, results_AXV_1.H_3, results_AXV_1.H_4_ideal...
);

% Refrigeration capacity
results_AXV_1.RC = capacity(...
    data.mass(idx_7), results_AXV_1.H_2, results_AXV_1.H_3...
);

results_AXV_1 = struct2table(results_AXV_1);
